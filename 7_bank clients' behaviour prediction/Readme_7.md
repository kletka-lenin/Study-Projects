# Прогнозирование оттока клиентов банка

По представленным данным о клиентах «Бета-Банка» и их поведении нужно **спрогнозировать, уйдёт клиент из банка в ближайшее время или нет** (так как в последние месяцы наблюдается небольшой отток клиентов). 

Для этого требуется решить **следующие задачи**:
* подготовить данные,
* обучить модели без учёта дисбаланса в целевом признаке и рассчитать метрики качества этих моделей,
* устранить дисбаланс в данных и обучить модели,
* выбрать наиболее эффективную модель с предельно большим значением *F1*-меры; дополнительно измерить *AUC-ROC*.

Источник данных: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

Предоставлены данные, содержащие 14 признаков, 10 тыс. строк.

Работа проводилась с помощью библиотек Pandas, Matplotlib, Seaborn, Scikit-learn.

**Выводы:**

В ходе исследования были выполнены следующие задачи:
* предоставленные данные были подготовлены для работы алгоритмов: удалены лишние столбцы, заполнены пропуски в столбце "Tenure", исследованы взаимосвязи, к категориальным признакам применена техника OHE, численные признаки масштабированы.
* было проведено исследование качества моделей, использующих алгоритмы классификации, - несмотря на дисбаланс классов целевого признака. Это исследование показало, что достичь порогового значения F1-меры не удаётся ни одной из моделей.
* затем были испробованы способы устранить дисбаланс классов: указание моделям на этот факт, умножение объектов с положительным целевым признаком и уменьшение количества объектов с негативным целевым признаком. Применение техники Upsampling не дало хороших результатов, более качественными оказались предсказания специально настроенных моделей, а наилучший эффект дало применение техники Downsampling к обучающему набору данных.
* В результате этого анализа выявилась лучшая модель - случайный лес с числом деревьев 700 и глубиной 10. Эта модель, обученная на downsampled выборке, эффективно сработала на тестовой выборке: удалось довести метрику F1 примерно до 0.6, а метрику AUC-ROC - до 0.85. Таким образом, модель показала качественное определение объектов положительного целевого класса. 
